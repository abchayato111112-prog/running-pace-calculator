<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ランニング時間換算ツール</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;500;600;700&family=Barlow:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        :root {
            --primary: #FF6B35;
            --primary-dark: #E85A2A;
            --secondary: #2EC4B6;
            --dark: #1A1A2E;
            --darker: #0F0F1A;
            --light: #F8FAFC;
            --accent: #FFD166;
            --green: #22C55E;
            --gradient-start: #FF6B35;
            --gradient-end: #FF9F1C;
            --card-bg: rgba(30, 30, 50, 0.9);
            --card-border: rgba(255, 255, 255, 0.08);
            --input-bg: rgba(0, 0, 0, 0.3);
            --input-border: rgba(255, 255, 255, 0.12);
            --text-muted: rgba(255, 255, 255, 0.45);
            --text-dim: rgba(255, 255, 255, 0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Barlow', sans-serif;
            background: var(--darker);
            min-height: 100vh;
            min-height: 100dvh;
            color: var(--light);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* Background Pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(ellipse at 20% 20%, rgba(255, 107, 53, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(46, 196, 182, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 640px;
            margin: 0 auto;
            padding: 24px 16px 100px;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 24px;
            padding: 16px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 24px rgba(255, 107, 53, 0.3);
            flex-shrink: 0;
        }

        .logo-icon .material-symbols-outlined {
            font-size: 28px;
            color: white;
        }

        .logo-text h1 {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--light);
            line-height: 1;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 4px;
            letter-spacing: 0.5px;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 4px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            padding: 4px;
            margin-bottom: 20px;
            position: sticky;
            top: 8px;
            z-index: 100;
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--card-border);
        }

        .tab-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 12px 8px;
            border: none;
            background: transparent;
            color: var(--text-muted);
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.25s ease;
            white-space: nowrap;
        }

        .tab-btn .material-symbols-outlined {
            font-size: 20px;
        }

        .tab-btn:hover {
            color: var(--light);
            background: rgba(255, 255, 255, 0.06);
        }

        .tab-btn:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: -2px;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.35);
        }

        /* Cards */
        .card {
            background: linear-gradient(145deg, var(--card-bg), rgba(20, 20, 35, 0.95));
            border-radius: 20px;
            padding: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            display: none;
        }

        .card.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 24px;
        }

        .card-icon {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .card-icon .material-symbols-outlined {
            font-size: 24px;
            color: white;
        }

        .card-icon.orange { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); }
        .card-icon.teal { background: linear-gradient(135deg, var(--secondary), #1FA89D); }
        .card-icon.yellow { background: linear-gradient(135deg, var(--accent), #E5B85A); }

        .card-title {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .card-subtitle {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 2px;
        }

        /* Input Group */
        .input-group {
            display: flex;
            align-items: center;
            gap: 0;
            background: var(--input-bg);
            border: 2px solid var(--input-border);
            border-radius: 14px;
            padding: 4px;
            transition: border-color 0.25s ease, box-shadow 0.25s ease;
        }

        .input-group:focus-within {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.15);
        }

        .input-field {
            flex: 1;
            text-align: center;
        }

        .input-field label {
            display: block;
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 4px 0 0;
            font-weight: 500;
        }

        .input-field input {
            width: 100%;
            padding: 6px 8px 10px;
            background: transparent;
            border: none;
            color: var(--light);
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1.6rem;
            font-weight: 600;
            letter-spacing: 2px;
            text-align: center;
        }

        .input-field input:focus {
            outline: none;
        }

        .input-field input::placeholder {
            color: rgba(255, 255, 255, 0.15);
        }

        /* Remove spinner arrows */
        .input-field input[type="number"]::-webkit-outer-spin-button,
        .input-field input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .input-field input[type="number"] {
            -moz-appearance: textfield;
        }

        .separator {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1.6rem;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.25);
            padding: 12px 2px 0;
            user-select: none;
        }

        /* Section label */
        .section-label {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 28px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-label::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255, 255, 255, 0.08);
        }

        /* Results Grid */
        .multi-results {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .result-box {
            padding: 14px 8px 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.04);
            text-align: center;
            transition: background 0.2s ease;
        }

        .result-box .result-label {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .result-box .result-value {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: 1px;
            color: var(--light);
            transition: color 0.3s ease;
        }

        .result-box .result-detail {
            font-size: 0.6rem;
            color: rgba(255, 255, 255, 0.3);
            margin-top: 4px;
        }

        /* Highlighted result boxes (half, full marathon) */
        .result-box.highlight {
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid rgba(255, 107, 53, 0.25);
        }

        .result-box.highlight .result-value {
            color: var(--accent);
            text-shadow: 0 0 20px rgba(255, 209, 102, 0.2);
        }

        .result-box.highlight .result-label {
            color: var(--primary);
        }

        /* Single Result Area (Card 2) */
        .result-area {
            margin-top: 24px;
            padding: 24px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            border: 1px solid rgba(255, 107, 53, 0.2);
            text-align: center;
        }

        .result-area .result-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .result-area .result-value {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 2.8rem;
            font-weight: 700;
            letter-spacing: 3px;
            color: var(--accent);
            text-shadow: 0 0 30px rgba(255, 209, 102, 0.2);
        }

        .result-area .result-detail {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-top: 8px;
        }

        /* Card 3 two-column results */
        .dual-results {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 24px;
        }

        .dual-results .result-box {
            padding: 20px 12px;
        }

        .dual-results .result-box .result-value {
            font-size: 1.6rem;
        }

        .dual-results .result-box .result-label {
            font-size: 0.7rem;
        }

        /* Reference Table */
        .reference-section {
            margin-top: 24px;
        }

        .reference-toggle {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-dim);
            padding: 12px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-family: 'Barlow', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.25s ease;
        }

        .reference-toggle:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(255, 107, 53, 0.06);
        }

        .reference-toggle:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .reference-toggle .material-symbols-outlined {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .reference-toggle.open .material-symbols-outlined {
            transform: rotate(180deg);
        }

        .reference-table-wrap {
            display: grid;
            grid-template-rows: 0fr;
            transition: grid-template-rows 0.35s ease;
            margin-top: 0;
        }

        .reference-table-wrap.show {
            grid-template-rows: 1fr;
            margin-top: 12px;
        }

        .reference-table-inner {
            overflow: hidden;
        }

        .reference-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .reference-table th,
        .reference-table td {
            padding: 10px 12px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .reference-table th {
            background: rgba(255, 107, 53, 0.15);
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-dim);
            position: sticky;
            top: 0;
        }

        .reference-table td {
            font-family: 'Barlow Condensed', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.7);
        }

        .reference-table tr:hover td {
            background: rgba(255, 255, 255, 0.04);
        }

        .reference-table tr.active-pace td {
            background: rgba(255, 107, 53, 0.12);
            color: var(--accent);
            font-weight: 600;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 32px 20px;
            color: rgba(255, 255, 255, 0.2);
            font-size: 0.8rem;
        }

        /* Responsive - Mobile */
        @media (max-width: 600px) {
            .container {
                padding: 16px 12px 100px;
            }

            .logo-text h1 {
                font-size: 1.5rem;
            }

            .tab-btn {
                padding: 10px 6px;
                font-size: 0.78rem;
            }

            .tab-btn .material-symbols-outlined {
                font-size: 18px;
            }

            .tab-btn .tab-label {
                display: none;
            }

            .tab-btn .tab-label-short {
                display: inline;
            }

            .card {
                padding: 20px 14px;
                border-radius: 16px;
            }

            .card-header {
                gap: 10px;
                margin-bottom: 20px;
            }

            .card-icon {
                width: 38px;
                height: 38px;
            }

            .card-icon .material-symbols-outlined {
                font-size: 20px;
            }

            .card-title {
                font-size: 1.05rem;
            }

            .multi-results {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }

            .result-box {
                padding: 12px 6px 10px;
            }

            .result-box .result-value {
                font-size: 1.1rem;
            }

            .result-box .result-label {
                font-size: 0.6rem;
            }

            .result-area .result-value {
                font-size: 2.2rem;
            }

            .dual-results .result-box .result-value {
                font-size: 1.3rem;
            }

            .reference-table th,
            .reference-table td {
                padding: 8px 6px;
                font-size: 0.85rem;
            }
        }

        /* Desktop Short Labels Hidden */
        .tab-label-short {
            display: none;
        }

        @media (max-width: 600px) {
            .tab-label-short {
                display: inline;
            }
            .tab-label {
                display: none;
            }
        }

        /* Small Mobile */
        @media (max-width: 380px) {
            .logo-text h1 {
                font-size: 1.3rem;
            }

            .subtitle {
                font-size: 0.75rem;
            }

            .tab-btn {
                padding: 10px 4px;
                font-size: 0.72rem;
                gap: 3px;
            }

            .multi-results {
                gap: 5px;
            }

            .result-box .result-value {
                font-size: 1rem;
            }
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Focus Visible */
        :focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        input:focus-visible {
            outline: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <span class="material-symbols-outlined">directions_run</span>
                </div>
                <div class="logo-text">
                    <h1>PACE CALCULATOR</h1>
                    <p class="subtitle">ランニング時間換算ツール</p>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-nav" role="tablist" aria-label="換算モード切り替え">
            <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="card-pace" data-tab="card-pace">
                <span class="material-symbols-outlined">pace</span>
                <span class="tab-label">1kmペース</span>
                <span class="tab-label-short">ペース</span>
            </button>
            <button class="tab-btn" role="tab" aria-selected="false" aria-controls="card-marathon" data-tab="card-marathon">
                <span class="material-symbols-outlined">emoji_events</span>
                <span class="tab-label">フルマラソン</span>
                <span class="tab-label-short">マラソン</span>
            </button>
            <button class="tab-btn" role="tab" aria-selected="false" aria-controls="card-track" data-tab="card-track">
                <span class="material-symbols-outlined">stadium</span>
                <span class="tab-label">トラック</span>
                <span class="tab-label-short">トラック</span>
            </button>
        </nav>

        <!-- Card 1: 1kmペース → 各距離タイム -->
        <div class="card active" id="card-pace" role="tabpanel">
            <div class="card-header">
                <div class="card-icon orange">
                    <span class="material-symbols-outlined">pace</span>
                </div>
                <div>
                    <div class="card-title">1KMペースから換算</div>
                    <div class="card-subtitle">各距離のタイムを一括計算</div>
                </div>
            </div>

            <div class="input-group">
                <div class="input-field">
                    <label for="pace-min">分</label>
                    <input type="number" id="pace-min" placeholder="5" min="0" max="30" value="5" inputmode="numeric">
                </div>
                <span class="separator">:</span>
                <div class="input-field">
                    <label for="pace-sec">秒</label>
                    <input type="number" id="pace-sec" placeholder="00" min="0" max="59" value="0" inputmode="numeric">
                </div>
            </div>

            <div class="section-label">距離別タイム</div>

            <div class="multi-results">
                <div class="result-box">
                    <div class="result-label">5km</div>
                    <div class="result-value" id="5km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">10km</div>
                    <div class="result-value" id="10km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">15km</div>
                    <div class="result-value" id="15km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">20km</div>
                    <div class="result-value" id="20km-result">--:--</div>
                </div>
                <div class="result-box highlight">
                    <div class="result-label">ハーフ</div>
                    <div class="result-value" id="half-result">--:--:--</div>
                    <div class="result-detail">21.0975km</div>
                </div>
                <div class="result-box">
                    <div class="result-label">25km</div>
                    <div class="result-value" id="25km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">30km</div>
                    <div class="result-value" id="30km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">35km</div>
                    <div class="result-value" id="35km-result">--:--</div>
                </div>
                <div class="result-box">
                    <div class="result-label">40km</div>
                    <div class="result-value" id="40km-result">--:--</div>
                </div>
                <div class="result-box highlight">
                    <div class="result-label">フルマラソン</div>
                    <div class="result-value" id="marathon-result">--:--:--</div>
                    <div class="result-detail">42.195km</div>
                </div>
                <div class="result-box">
                    <div class="result-label">トラック1周</div>
                    <div class="result-value" id="track-result">--秒</div>
                    <div class="result-detail">400m</div>
                </div>
            </div>

            <div class="reference-section">
                <button class="reference-toggle" onclick="toggleReference()" aria-expanded="false" aria-controls="reference-table-wrap">
                    <span class="material-symbols-outlined">expand_more</span>
                    参考ペース表
                </button>
                <div class="reference-table-wrap" id="reference-table-wrap">
                    <div class="reference-table-inner">
                        <div class="reference-table">
                            <table>
                                <thead>
                                    <tr>
                                        <th>1kmペース</th>
                                        <th>フルマラソン</th>
                                        <th>トラック1周</th>
                                    </tr>
                                </thead>
                                <tbody id="reference-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Card 2: フルマラソンタイム → 1kmペース -->
        <div class="card" id="card-marathon" role="tabpanel">
            <div class="card-header">
                <div class="card-icon teal">
                    <span class="material-symbols-outlined">emoji_events</span>
                </div>
                <div>
                    <div class="card-title">フルマラソンタイムから換算</div>
                    <div class="card-subtitle">1kmあたりのペースを逆算</div>
                </div>
            </div>

            <div class="input-group">
                <div class="input-field">
                    <label for="marathon-hour">時間</label>
                    <input type="number" id="marathon-hour" placeholder="3" min="0" max="10" value="3" inputmode="numeric">
                </div>
                <span class="separator">:</span>
                <div class="input-field">
                    <label for="marathon-min">分</label>
                    <input type="number" id="marathon-min" placeholder="00" min="0" max="59" value="0" inputmode="numeric">
                </div>
                <span class="separator">:</span>
                <div class="input-field">
                    <label for="marathon-sec">秒</label>
                    <input type="number" id="marathon-sec" placeholder="00" min="0" max="59" value="0" inputmode="numeric">
                </div>
            </div>

            <div class="result-area">
                <div class="result-label">1kmあたりのペース</div>
                <div class="result-value" id="pace-result">-'--"</div>
                <div class="result-detail">このペースで42.195kmを走ります</div>
            </div>
        </div>

        <!-- Card 3: トラック1周タイム → 各種換算 -->
        <div class="card" id="card-track" role="tabpanel">
            <div class="card-header">
                <div class="card-icon yellow">
                    <span class="material-symbols-outlined">stadium</span>
                </div>
                <div>
                    <div class="card-title">トラック1周タイムから換算</div>
                    <div class="card-subtitle">400mタイムからペース・マラソンを算出</div>
                </div>
            </div>

            <div class="input-group">
                <div class="input-field">
                    <label for="track-min">分</label>
                    <input type="number" id="track-min" placeholder="1" min="0" max="10" value="1" inputmode="numeric">
                </div>
                <span class="separator">:</span>
                <div class="input-field">
                    <label for="track-sec">秒</label>
                    <input type="number" id="track-sec" placeholder="30" min="0" max="59" value="30" inputmode="numeric">
                </div>
            </div>

            <div class="dual-results">
                <div class="result-box highlight">
                    <div class="result-label">1kmペース</div>
                    <div class="result-value" id="track-pace-result">-'--"</div>
                </div>
                <div class="result-box highlight">
                    <div class="result-label">フルマラソン</div>
                    <div class="result-value" id="track-marathon-result">--:--:--</div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>フルマラソン: 42.195km | ハーフ: 21.0975km | トラック: 400m</p>
    </footer>

    <script>
        const MARATHON_DISTANCE = 42.195;
        const HALF_MARATHON_DISTANCE = 21.0975;
        const TRACK_DISTANCE = 0.4;

        // --- Tab Navigation ---
        const tabBtns = document.querySelectorAll('.tab-btn');
        const cards = document.querySelectorAll('.card');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetId = btn.dataset.tab;

                tabBtns.forEach(b => {
                    b.classList.remove('active');
                    b.setAttribute('aria-selected', 'false');
                });
                btn.classList.add('active');
                btn.setAttribute('aria-selected', 'true');

                cards.forEach(c => c.classList.remove('active'));
                document.getElementById(targetId).classList.add('active');
            });
        });

        // --- Time Conversion Utilities ---
        function secondsToHMS(totalSeconds) {
            if (isNaN(totalSeconds) || totalSeconds <= 0) return '--:--:--';
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = Math.round(totalSeconds % 60);
            return `${hours}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function secondsToMinSec(totalSeconds) {
            if (isNaN(totalSeconds) || totalSeconds <= 0) return "-'--\"";
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = Math.round(totalSeconds % 60);
            return `${minutes}'${String(seconds).padStart(2, '0')}"`;
        }

        function secondsToTrackTime(totalSeconds) {
            if (isNaN(totalSeconds) || totalSeconds <= 0) return '--秒';
            const totalSecondsRounded = Math.round(totalSeconds);
            if (totalSeconds < 60) {
                return `${totalSecondsRounded}秒`;
            } else {
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = Math.round(totalSeconds % 60);
                return `${minutes}分${String(seconds).padStart(2, '0')}秒`;
            }
        }

        function secondsToTimeAuto(totalSeconds) {
            if (isNaN(totalSeconds) || totalSeconds <= 0) return '--:--';
            if (totalSeconds >= 3600) {
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = Math.round(totalSeconds % 60);
                return `${hours}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            } else {
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = Math.round(totalSeconds % 60);
                return `${minutes}:${String(seconds).padStart(2, '0')}`;
            }
        }

        // --- Card 1: 1kmペースからの換算 ---
        function calculateFromPace() {
            const min = parseFloat(document.getElementById('pace-min').value) || 0;
            const sec = parseFloat(document.getElementById('pace-sec').value) || 0;
            const paceInSeconds = min * 60 + sec;

            if (paceInSeconds <= 0) {
                document.getElementById('5km-result').textContent = '--:--';
                document.getElementById('10km-result').textContent = '--:--';
                document.getElementById('15km-result').textContent = '--:--';
                document.getElementById('20km-result').textContent = '--:--';
                document.getElementById('half-result').textContent = '--:--:--';
                document.getElementById('25km-result').textContent = '--:--';
                document.getElementById('30km-result').textContent = '--:--';
                document.getElementById('35km-result').textContent = '--:--';
                document.getElementById('40km-result').textContent = '--:--';
                document.getElementById('marathon-result').textContent = '--:--:--';
                document.getElementById('track-result').textContent = '--秒';
                return;
            }

            document.getElementById('5km-result').textContent = secondsToTimeAuto(paceInSeconds * 5);
            document.getElementById('10km-result').textContent = secondsToTimeAuto(paceInSeconds * 10);
            document.getElementById('15km-result').textContent = secondsToTimeAuto(paceInSeconds * 15);
            document.getElementById('20km-result').textContent = secondsToTimeAuto(paceInSeconds * 20);
            document.getElementById('25km-result').textContent = secondsToTimeAuto(paceInSeconds * 25);
            document.getElementById('30km-result').textContent = secondsToTimeAuto(paceInSeconds * 30);
            document.getElementById('35km-result').textContent = secondsToTimeAuto(paceInSeconds * 35);
            document.getElementById('40km-result').textContent = secondsToTimeAuto(paceInSeconds * 40);

            const halfSeconds = paceInSeconds * HALF_MARATHON_DISTANCE;
            document.getElementById('half-result').textContent = secondsToHMS(halfSeconds);

            const marathonSeconds = paceInSeconds * MARATHON_DISTANCE;
            document.getElementById('marathon-result').textContent = secondsToHMS(marathonSeconds);

            const trackSeconds = paceInSeconds * TRACK_DISTANCE;
            document.getElementById('track-result').textContent = secondsToTrackTime(trackSeconds);

            highlightActivePace(paceInSeconds);
        }

        // --- Card 2: フルマラソンタイムからの換算 ---
        function calculateFromMarathon() {
            const hours = parseFloat(document.getElementById('marathon-hour').value) || 0;
            const min = parseFloat(document.getElementById('marathon-min').value) || 0;
            const sec = parseFloat(document.getElementById('marathon-sec').value) || 0;
            const totalSeconds = hours * 3600 + min * 60 + sec;

            if (totalSeconds <= 0) {
                document.getElementById('pace-result').textContent = "-'--\"";
                return;
            }

            const paceSeconds = totalSeconds / MARATHON_DISTANCE;
            document.getElementById('pace-result').textContent = secondsToMinSec(paceSeconds);
        }

        // --- Card 3: トラック1周タイムからの換算 ---
        function calculateFromTrack() {
            const min = parseFloat(document.getElementById('track-min').value) || 0;
            const sec = parseFloat(document.getElementById('track-sec').value) || 0;
            const trackSeconds = min * 60 + sec;

            if (trackSeconds <= 0) {
                document.getElementById('track-pace-result').textContent = "-'--\"";
                document.getElementById('track-marathon-result').textContent = '--:--:--';
                return;
            }

            const paceSeconds = trackSeconds / TRACK_DISTANCE;
            document.getElementById('track-pace-result').textContent = secondsToMinSec(paceSeconds);

            const marathonSeconds = paceSeconds * MARATHON_DISTANCE;
            document.getElementById('track-marathon-result').textContent = secondsToHMS(marathonSeconds);
        }

        // --- Reference Table ---
        function toggleReference() {
            const wrap = document.getElementById('reference-table-wrap');
            const btn = document.querySelector('.reference-toggle');
            const isOpen = wrap.classList.toggle('show');
            btn.classList.toggle('open', isOpen);
            btn.setAttribute('aria-expanded', isOpen);
        }

        function highlightActivePace(paceInSeconds) {
            const rows = document.querySelectorAll('#reference-tbody tr');
            rows.forEach(row => {
                const rowPace = parseInt(row.dataset.pace, 10);
                const diff = Math.abs(rowPace - paceInSeconds);
                row.classList.toggle('active-pace', diff < 5);
            });
        }

        function generateReferenceTable() {
            const tbody = document.getElementById('reference-tbody');
            for (let totalSec = 180; totalSec <= 360; totalSec += 10) {
                const min = Math.floor(totalSec / 60);
                const sec = totalSec % 60;
                const paceSeconds = min * 60 + sec;
                const marathonSeconds = paceSeconds * MARATHON_DISTANCE;
                const trackSeconds = paceSeconds * TRACK_DISTANCE;

                const row = document.createElement('tr');
                row.dataset.pace = paceSeconds;
                row.innerHTML = `
                    <td>${min}'${String(sec).padStart(2, '0')}"</td>
                    <td>${secondsToHMS(marathonSeconds)}</td>
                    <td>${secondsToTrackTime(trackSeconds)}</td>
                `;
                tbody.appendChild(row);
            }
        }

        // --- Event Listeners ---
        document.getElementById('pace-min').addEventListener('input', calculateFromPace);
        document.getElementById('pace-sec').addEventListener('input', calculateFromPace);

        document.getElementById('marathon-hour').addEventListener('input', calculateFromMarathon);
        document.getElementById('marathon-min').addEventListener('input', calculateFromMarathon);
        document.getElementById('marathon-sec').addEventListener('input', calculateFromMarathon);

        document.getElementById('track-min').addEventListener('input', calculateFromTrack);
        document.getElementById('track-sec').addEventListener('input', calculateFromTrack);

        // --- Init ---
        generateReferenceTable();
        calculateFromPace();
        calculateFromMarathon();
        calculateFromTrack();
    </script>
</body>
</html>
